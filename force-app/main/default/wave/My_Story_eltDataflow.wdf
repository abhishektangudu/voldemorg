["{\"nodes\":{\"Compute_Fields_For_Opportunity\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Count\",\"name\":\"Count\",\"precision\":16,\"saqlExpression\":\"1\",\"scale\":0,\"type\":\"Numeric\"},{\"label\":\"Age\",\"name\":\"Age\",\"precision\":18,\"saqlExpression\":\"case    when IsClosed == \\\"false\\\"     then daysBetween(toDate(CreatedDate_sec_epoch), now())     else daysBetween(toDate(CreatedDate_sec_epoch),toDate(CloseDate_sec_epoch))     end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"DaysSinceClosed\",\"name\":\"DaysSinceClosed\",\"precision\":16,\"saqlExpression\":\"daysBetween(toDate(CloseDate_sec_epoch), now()) \",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Extract_Opportunity\"]},\"Compute_Aggregate_Fields\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"0\",\"label\":\"AvgerageDealSize\",\"name\":\"AvgerageDealSize\",\"precision\":16,\"saqlExpression\":\"'Aggregates.LTV'/'Aggregates.NumberOfWonDeals'\\n\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"AvgerageDealAge\",\"name\":\"AvgerageDealAge\",\"precision\":16,\"saqlExpression\":\"'Aggregates.TotalAge'\\n/'Aggregates.NumberOfWonDeals'\\n\",\"scale\":2,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"DaysSinceFirstDealDate\",\"name\":\"DaysSinceFirstDealDate\",\"precision\":16,\"saqlExpression\":\"case when 'Aggregates.FirstDealDate' is null then 0 else daysBetween(toDate('Aggregates.FirstDealDate_sec_epoch'), now())  end\",\"scale\":0,\"type\":\"Numeric\"},{\"defaultValue\":\"0\",\"label\":\"DaysSinceLastDealDate\",\"name\":\"DaysSinceLastDealDate\",\"precision\":16,\"saqlExpression\":\"case when 'Aggregates.CloseDate' is null then 0 else daysBetween(toDate('Aggregates.CloseDate_sec_epoch'), now())  end\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Join_Account_Opportunity_Aggregates\"]},\"GenerateAccountBasedMetrics\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"previous('LTV') + 'Amount'\",\"type\":\"Numeric\",\"scale\":2},\"label\":\"LTV\",\"name\":\"LTV\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"previous('NumberOfWonDeals')+1\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"NumberOfWonDeals\",\"name\":\"NumberOfWonDeals\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"previous('TotalAge') + Age\",\"type\":\"Numeric\",\"scale\":0},\"label\":\"TotalAge\",\"name\":\"TotalAge\"},{\"expression\":{\"saqlExpression\":\"case when next('Id') is null then \\\"true\\\" else \\\"false\\\" end\",\"type\":\"Text\"},\"label\":\"LastRow\",\"name\":\"LastRow\"},{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"CloseDate\"},\"label\":\"FirstDealDate\",\"name\":\"FirstDealDate\"}],\"orderBy\":[{\"direction\":\"asc\",\"name\":\"CloseDate\"}],\"partitionBy\":[\"AccountId\"]},\"sources\":[\"Filter_Won_Opportunities\"]},\"Filter_Won_Opportunities\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'IsWon'==\\\"true\\\" && DaysSinceClosed < 365\"},\"sources\":[\"Compute_Fields_For_Opportunity\"]},\"Extract_Opportunity\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"AccountId\"},{\"name\":\"OwnerId\"},{\"name\":\"Name\"},{\"name\":\"StageName\"},{\"name\":\"LeadSource\"},{\"name\":\"IsWon\"},{\"name\":\"Type\"},{\"name\":\"IsClosed\"},{\"name\":\"ForecastCategory\"},{\"name\":\"ForecastCategoryName\"},{\"name\":\"CreatedDate\"},{\"name\":\"CloseDate\"},{\"name\":\"Amount\"},{\"name\":\"CreatedById\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"LastActivityDate\"},{\"name\":\"HasOpportunityLineItem\"}],\"object\":\"Opportunity\"}},\"Drop_Fields\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"Aggregates.TotalAge\"}],\"mode\":\"drop\"},\"sources\":[\"Compute_Aggregate_Fields\"]},\"Join_Account_Opportunity_Aggregates\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Aggregates\",\"rightKey\":[\"AccountId\"],\"rightSelect\":[\"LTV\",\"NumberOfWonDeals\",\"TotalAge\",\"FirstDealDate\",\"CloseDate\"]},\"sources\":[\"Extract_Account\",\"Filter_LastRow\"]},\"Register_Accounts\":{\"action\":\"register\",\"parameters\":{\"label\":\"Account Training Dataset\",\"name\":\"Accounts\"},\"sources\":[\"Drop_Fields\"]},\"Extract_Account\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"AnnualRevenue\"},{\"name\":\"BillingCountry\"},{\"name\":\"BillingState\"},{\"name\":\"CreatedDate\"},{\"name\":\"Id\"},{\"name\":\"Industry\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"Name\"},{\"name\":\"NumberOfEmployees\"},{\"name\":\"OwnerId\"},{\"name\":\"Type\"},{\"name\":\"AccountSource\"}],\"object\":\"Account\"}},\"Filter_LastRow\":{\"action\":\"filter\",\"parameters\":{\"saqlFilter\":\"'LastRow' == \\\"true\\\"\"},\"sources\":[\"GenerateAccountBasedMetrics\"]}}}",null]